<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>e稲沢 業務報告作成BOT</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f8fafc; }
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); border-radius: 4px; }
        input[type=number]::-webkit-inner-spin-button, input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        const INQUIRY_LABELS = { newspaper: '新聞折込', posting: 'ポスティング', flyer: 'チラシ設置', crayon: 'クレヨン', intro: '紹介', hp: 'ホームページ', litalico: 'リタリコ仕事ナビ', previous: '以前問い合わせ者', unknown: '不明' };
        const INITIAL_INQUIRY = { newspaper: 0, posting: 0, flyer: 0, crayon: 0, intro: 0, hp: 0, litalico: 0, previous: 0, unknown: 0 };
        const INITIAL_REPORT = { departmentName: 'e稲沢', reportDate: new Date().toISOString().split('T')[0], contractCount: 0, userCount: 0, postingDaily: 0, flyerDaily: 0, generalRemarks: '', inquiryDaily: { ...INITIAL_INQUIRY } };
        const INITIAL_CUMULATIVE = { month: (new Date().getMonth() + 1).toString(), postingTotal: 0, flyerTotal: 0, inquiryTotal: { ...INITIAL_INQUIRY } };

        const UniversalInput = ({ value, onChange, unit, label, theme = 'light' }) => {
            const isIndigo = theme === 'indigo';
            return (
                <div className="mb-4">
                    <label className="text-[10px] font-bold text-slate-500 block mb-1 uppercase tracking-widest">{label}</label>
                    <div className="flex h-12">
                        <button onClick={() => onChange(Math.max(0, value - 1))} className={`px-4 rounded-l-xl border-2 ${isIndigo ? 'bg-indigo-100' : 'bg-slate-100'}`}>-</button>
                        <input type="number" value={value} onChange={(e) => onChange(parseInt(e.target.value) || 0)} className="flex-1 text-center border-y-2 font-bold text-lg outline-none" />
                        <button onClick={() => onChange(value + 1)} className="px-4 rounded-r-xl border-2 bg-indigo-600 text-white">+</button>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [report, setReport] = useState(INITIAL_REPORT);
            const [cumulative, setCumulative] = useState(INITIAL_CUMULATIVE);
            const [isCopied, setIsCopied] = useState(false);

            const generatedReport = useMemo(() => {
                const inquiryText = Object.keys(INQUIRY_LABELS).map(k => `${INQUIRY_LABELS[k].padEnd(8, '　')} ${report.inquiryDaily[k]}件`).join('\n');
                return `${report.departmentName} (${report.reportDate})\n\n【契約人数】 ${report.contractCount}人\n【利用人数】 ${report.userCount}人\n\n【備考】\n${report.generalRemarks}\n\n【ポスティング数】 ${report.postingDaily}枚\n\n【問合せ】\n${inquiryText}`;
            }, [report]);

            const copyToClipboard = () => {
                navigator.clipboard.writeText(generatedReport);
                setIsCopied(true);
                setTimeout(() => setIsCopied(false), 2000);
            };

            return (
                <div className="min-h-screen bg-slate-100 p-4 md:p-8">
                    <div className="max-w-5xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div className="bg-white p-6 rounded-3xl shadow-lg space-y-6">
                            <h1 className="text-2xl font-black text-indigo-900 mb-6">業務報告作成BOT</h1>
                            <div className="grid grid-cols-2 gap-4">
                                <input type="text" value={report.departmentName} onChange={e => setReport({...report, departmentName: e.target.value})} className="border-2 p-3 rounded-xl font-bold" />
                                <input type="date" value={report.reportDate} onChange={e => setReport({...report, reportDate: e.target.value})} className="border-2 p-3 rounded-xl" />
                            </div>
                            <UniversalInput label="契約人数" unit="人" value={report.contractCount} onChange={v => setReport({...report, contractCount: v})} />
                            <UniversalInput label="利用人数" unit="人" value={report.userCount} onChange={v => setReport({...report, userCount: v})} />
                            <textarea className="w-full border-2 p-4 rounded-2xl h-32" placeholder="備考を入力" onChange={e => setReport({...report, generalRemarks: e.target.value})} />
                        </div>
                        <div className="bg-slate-900 rounded-3xl p-6 text-emerald-400 font-mono h-fit sticky top-8 shadow-2xl">
                            <div className="flex justify-between items-center mb-4 border-b border-slate-700 pb-4">
                                <span className="text-xs font-bold text-slate-400">PREVIEW</span>
                                <button onClick={copyToClipboard} className="bg-indigo-600 text-white px-6 py-2 rounded-full font-bold text-sm">
                                    {isCopied ? 'コピー完了！' : 'コピーする'}
                                </button>
                            </div>
                            <div className="whitespace-pre-wrap">{generatedReport}</div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
